# TODO

p0:

- [X] 项目初始化，创建项目目录结构
- [ ] 做出内网穿透 Demo，单端口，配置写死

p1 - MVP:

- [ ] 核心逻辑，支持多端口穿透
  - 服务端通过启动命令控制监听的端口
  - 客户端通过启动命令控制连接的服务端 IP 和监听端口
  - 通过连接池管理端口映射，支持动态端口分配
- [ ] 配置管理 - urfave/cli
  - 通过命令行工具接收启动参数
  - 热重载配置文件
  - 通过 SQLite 管理配置信息，包括服务端监听端口，内网穿透映射端口，服务端管理员登录账号密码等
- [ ] 命令行工具 - 自定义
  - 客户端、服务端可通过命令关闭服务
  - 管理配置，包括查看、修改、添加、删除配置
  - 支持查看服务端状态，如端口监听情况，客户端连接情况
  - 支持查看客户端状态，如连接情况，流量统计等

p2:

- [ ] 安全机制 - TLS 加密
  - 支持通过服务端签发 TLS 证书，客户端使用 TLS 连接服务端
  - 客户端和服务端之间的所有数据都通过 TLS 加密传输
- [ ] 详细日志 - zap/sqlite
  - 通过 zap 封装日志，支持不同级别日志输出
  - 客户端日志，包括连接、断开、错误等
  - 服务端通过 - SQLite 记录日志
    - Web 面板日志，包括登录、客户端连接/断开、近期客户端连接稳定性
    - 命令行日志，包括启动、关闭、错误等，并输出到 txt 文件保存
- [ ] API 接口 - net/http
  - 服务端登录、修改账户密码等
  - 查看客户端连接情况、端口列表、流量统计、日志等
  - 配置监听端口、映射端口，支持动态端口分配
- [ ] 控制面板 - template/html
  - 服务端通过web面板控制，启动后打开 web 网页地址操作
  - 映射端口配置管理，支持动态端口分配
  - 映射端口列表（每条映射的实时状态），在线 tunnel 配置/重启

p3:

- [ ] 心跳机制
  - 客户端服务存活检测，定时检测 tunnel 对应的本地服务是否在线
  - 心跳断线自动重连机制
  - 可通过面板查看客户端状态以及稳定性
- [ ] 监控与性能优化
  - 对内网穿透过程中的关键指标进行监控，如连接数、流量、延迟等。
  - 基于监控数据进行性能优化，实现限速、流量统计等功能，确保系统的高效稳定运行。
- [ ] 构建与部署相关
  - makefile 脚本，支持一键编译，生成可执行文件
  - docker-compose 脚本，支持一键启动服务端和客户端
- [ ] 安全加强
  - 设置白名单，仅 IP 白名单可访问穿透的服务
  - 控制面板仅可通过本机访问
  - 服务端登录使用 token 验证，防止非法访问

**more**

- [ ] 内网穿透 UDP 连接支持
- [ ] 服务端支持启动为 linux 服务，通过 systemctl 管理，可通过 linux 终端操作
- [ ] 支持自定义子域名
- [ ] TCP/UDP 代理
- [ ] 多客户端支持
- [ ] Webhook 通知，发送邮件
- [ ] 客户端添加端口扫描，默认关闭，可通过启动时命令行开启，并反复确认是否开启


# 项目排期

- [ ] 2025-07-8 完成 MVP 版基础功能
- [ ] 2025-07-12 完成 p1, 发布 v0.1 版本
- [ ] 2025-07-15 完成 p2, 发布 v0.2 版本
- [ ] 2025-07-18 完成 p3, 发布 v0.3 版本
- [ ] 2025-07-19 完成测试，发布 v1.0-bate 版本


| 功能/模块    | 描述                                  | 分配  |
|----------|-------------------------------------|-----|
| 内网穿透核心逻辑 | 通过连接池管理连接，支持多端口穿透                   | 闫金柯 |
| 命令行工具    | 自定义命令解析，程序运行后通过命令查看状态、操作配置等，对程序进行控制 | 许正阳 |
| 配置管理     | 接收启动参数，通过sqlite管理配置，支持热重载           | 李恭  |
| TLS 身份认证 | 服务端签发 TLS 证书，客户端使用 TLS 连接服务端        | 闫金柯 |
| TLS 加密传输 | 客户端和服务端之间的所有数据都通过 TLS 加密传输          | 闫金柯 |
| API接口    | 为 web 面板提供 api 接口                   | 李恭  |
| web面板    | 通过 web 面板控制程序                       | 李恭  |
| 日志模块     | 封装 zap，结合 sqlite，记录详细日志             | 许正阳 |
| 心跳机制     | 客户端服务存活检测，断线重连机制                    | 许正阳 |
| 监控与性能优化  | 传输限速、流量统计，监控系统稳定性等                  | 闫金柯 |
| 构建与部署相关  | makefile、docker相关                   | 李恭  |
| 安全加强     | 连接白名单、登录安全                          | 闫金柯 |

